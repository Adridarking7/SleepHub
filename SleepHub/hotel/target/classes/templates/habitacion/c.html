<style>
    /* Contenedor principal */
    .container {
        max-width: 480px;
        margin: 30px auto;
        margin-top: 80px;
        background: #fff;
        padding: 20px 20px 30px 20px;
        border-radius: 12px;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        font-size: 0.9rem;
        /* fuente un poco más pequeña */
    }

    /* Título */
    .container h1 {
        color: #1e3d59;
        text-align: center;
        margin-bottom: 20px;
        font-weight: 700;
        font-size: 1.6rem;
    }

    /* Labels */
    label {
        display: block;
        font-weight: 600;
        color: #333;
        margin-bottom: 6px;
        margin-top: 14px;
    }

    /* Inputs, selects, textarea */
    input[type="number"],
    input[type="file"],
    select,
    textarea {
        width: 100%;
        padding: 8px 10px;
        font-size: 0.9rem;
        border: 1px solid #ccc;
        border-radius: 6px;
        box-sizing: border-box;
        transition: border-color 0.3s ease;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    /* Cambiar borde al hacer foco */
    input[type="number"]:focus,
    input[type="file"]:focus,
    select:focus,
    textarea:focus {
        outline: none;
        border-color: #1e3d59;
    }

    /* Textarea ajuste */
    textarea {
        min-height: 80px;
        resize: vertical;
    }

    /* Botón submit */
    input[type="submit"] {
        margin-top: 25px;
        background-color: #1e3d59;
        color: white;
        border: none;
        padding: 12px;
        width: 100%;
        border-radius: 8px;
        font-size: 1rem;
        cursor: pointer;
        font-weight: 600;
        transition: background-color 0.3s ease, transform 0.2s ease;
    }

    input[type="submit"]:hover {
        background-color: #2a4f73;
        transform: translateY(-2px);
    }

    /* Texto pequeño debajo input file */
    small {
        color: #6c757d;
        font-size: 0.8rem;
        display: block;
        margin-top: 4px;
    }

    /* Vista previa imágenes */
    .preview-wrapper {
        position: relative;
        display: inline-block;
        margin: 4px 5px 0 0;
    }

    .preview-wrapper img {
        width: 70px;
        height: 70px;
        object-fit: cover;
        border-radius: 8px;
        box-shadow: 0 0 6px rgba(0, 0, 0, 0.2);
    }

    /* Botón eliminar imagen */
    .delete-btn {
        position: absolute;
        top: -5px;
        right: -5px;
        background: #d11a2a;
        color: white;
        border: none;
        border-radius: 50%;
        width: 20px;
        height: 20px;
        font-size: 13px;
        font-weight: bold;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);
        transition: background 0.2s ease;
    }

    .delete-btn:hover {
        background: #a10014;
    }
</style>

<div class="container">
    <h1>Nueva habitación</h1>

    <div th:if="${error}" class="alert alert-danger">
        <p th:text="${error}"></p>
    </div>

    <form action="/habitacion/c" method="post" enctype="multipart/form-data">
        <label for="numero">Número:</label>
        <input type="number" id="numero" name="numero" required>

        <label for="tipo">Tipo:</label>
        <select id="tipo" name="tipo" required>
            <option th:each="t : ${tipos}" th:value="${t}" th:text="${t}"></option>
        </select>

        <label for="precio">Precio (€):</label>
        <input type="number" step="1" id="precio" name="precio" required>

        <label for="capacidad">Capacidad:</label>
        <input type="number" id="capacidad" name="capacidad" required>

        <label for="descripcion">Descripción:</label>
        <textarea id="descripcion" name="descripcion"></textarea>

        <label for="imagenes">Imágenes:</label>
        <input type="file" id="imagenes" name="imagenes" accept="image/*" multiple>
        <small>Puedes seleccionar varias veces para añadir más imágenes.</small>

        <div id="preview" style="margin-top: 8px;"></div>

        <input type="submit" value="Crear habitación">
    </form>
</div>

<script>
    let archivosSeleccionados = [];

    const input = document.getElementById("imagenes");
    const preview = document.getElementById("preview");

    function actualizarVistaPrevia() {
        preview.innerHTML = "";

        archivosSeleccionados.forEach((file, index) => {
            const wrapper = document.createElement("div");
            wrapper.classList.add("preview-wrapper");

            const img = document.createElement("img");
            img.src = URL.createObjectURL(file);

            const deleteBtn = document.createElement("button");
            deleteBtn.innerHTML = "✖";
            deleteBtn.className = "delete-btn";

            deleteBtn.addEventListener("click", (e) => {
                e.preventDefault(); // Evita que el botón envíe el formulario por accidente
                archivosSeleccionados.splice(index, 1);
                actualizarVistaPrevia();
            });

            wrapper.appendChild(img);
            wrapper.appendChild(deleteBtn);
            preview.appendChild(wrapper);
        });

        const dataTransfer = new DataTransfer();
        archivosSeleccionados.forEach(file => dataTransfer.items.add(file));
        input.files = dataTransfer.files;
    }

    input.addEventListener("change", function (event) {
        const nuevosArchivos = Array.from(event.target.files);

        nuevosArchivos.forEach(nuevo => {
            const yaExiste = archivosSeleccionados.some(
                antiguo => antiguo.name === nuevo.name && antiguo.size === nuevo.size
            );
            if (!yaExiste) archivosSeleccionados.push(nuevo);
        });

        actualizarVistaPrevia();
    });
</script>